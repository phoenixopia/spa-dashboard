(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2216],{6822:(e,t,s)=>{Promise.resolve().then(s.bind(s,9442))},9442:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),r=s(2115),l=s(3464);let n=()=>{if("undefined"!=typeof document){let e=document.cookie.split("; ").find(e=>e.startsWith("token="));return e?decodeURIComponent(e.split("=")[1]):null}return null};function d(){let[e,t]=(0,r.useState)(""),[s,d]=(0,r.useState)(""),[i]=(0,r.useState)("********"),[o,c]=(0,r.useState)(null),[u,p]=(0,r.useState)(!1),[x,h]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[b,v]=(0,r.useState)(""),[f,w]=(0,r.useState)(""),[y,N]=(0,r.useState)(null),[j,C]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let e=n();if(!e)return;let s=(await l.A.get("".concat("https://spa-backend-test.vercel.app/api","/user/single"),{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!0})).data.data;t(s.firstName),d(s.email)}catch(t){var e,s;N({type:"error",text:(null==t?void 0:null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to fetch user data."})}})()},[]);let k=()=>{p(!1),c(null),h(""),g(""),v(""),w(""),N(null),C(!1)},S=async()=>{var e,s,a;let r=n();if(!r){N({type:"error",text:"No token found. Please log in again."});return}let i={Authorization:"Bearer ".concat(r)};C(!0);try{let s;if("password"===o){if(b!==f||b.length<6){N({type:"error",text:"Passwords do not match or are too short."}),C(!1);return}s=await l.A.put("".concat("https://spa-backend-test.vercel.app/api","/user/edit"),{oldPassword:m,newPassword:b},{headers:i,withCredentials:!0})}else x.trim()&&(s=await l.A.put("".concat("https://spa-backend-test.vercel.app/api","/user/edit"),{[o]:x},{headers:i,withCredentials:!0}),"firstName"===o&&t(x),"email"===o&&d(x));let a=(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Update successful.";N({type:"success",text:a}),setTimeout(()=>k(),1200)}catch(e){N({type:"error",text:(null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Something went wrong."}),C(!1)}};return(0,a.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 py-6 md:ml-[260px]",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-10",children:"User Settings"}),(0,a.jsxs)("div",{className:"space-y-6 bg-white p-6 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3 border-b border-gray-200 pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-base font-semibold text-gray-800",children:"Name"}),(0,a.jsx)("div",{className:"text-sm text-gray-500 underline",children:e})]}),(0,a.jsx)("button",{onClick:()=>{c("firstName"),p(!0),h(e)},className:"bg-green-500 text-white px-4 py-1.5 rounded-lg hover:bg-green-600 transition",children:"Change"})]}),(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3 border-b border-gray-200 pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-base font-semibold text-gray-800",children:"Email"}),(0,a.jsx)("div",{className:"text-sm text-gray-500 underline",children:s})]}),(0,a.jsx)("button",{onClick:()=>{c("email"),p(!0),h(s)},className:"bg-green-500 text-white px-4 py-1.5 rounded-lg hover:bg-green-600 transition",children:"Change"})]}),(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3 border-b border-gray-200 pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-base font-semibold text-gray-800",children:"Password"}),(0,a.jsx)("div",{className:"text-sm text-gray-500 underline",children:i})]}),(0,a.jsx)("button",{onClick:()=>{c("password"),p(!0)},className:"bg-green-500 text-white px-4 py-1.5 rounded-lg hover:bg-green-600 transition",children:"Change"})]})]}),u&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-md rounded-xl shadow-lg p-6 space-y-6 relative",children:[y&&(0,a.jsx)("div",{className:"mb-6 px-4 py-3 rounded-md text-sm font-medium ".concat("success"===y.type?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:y.text}),(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-800",children:["Change ",o?o.charAt(0).toUpperCase()+o.slice(1):""]}),"password"===o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{type:"password",placeholder:"Old Password",className:"w-full p-3 border rounded-lg",value:m,onChange:e=>g(e.target.value)}),(0,a.jsx)("input",{type:"password",placeholder:"New Password",className:"w-full p-3 border rounded-lg",value:b,onChange:e=>v(e.target.value)}),(0,a.jsx)("input",{type:"password",placeholder:"Confirm New Password",className:"w-full p-3 border rounded-lg",value:f,onChange:e=>w(e.target.value)})]}):(0,a.jsx)("input",{type:"email"===o?"email":"text",className:"w-full p-3 border rounded-lg",value:x,onChange:e=>h(e.target.value)}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,a.jsx)("button",{onClick:k,className:"px-4 py-2 text-gray-600 hover:underline",disabled:j,children:"Cancel"}),(0,a.jsxs)("button",{onClick:S,className:"px-5 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition flex items-center",disabled:j,children:[j?(0,a.jsx)("span",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}):null,j?"Saving...":"Save"]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3464,8441,1684,7358],()=>t(6822)),_N_E=e.O()}]);