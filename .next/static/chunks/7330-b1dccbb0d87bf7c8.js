"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7330],{7330:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var s=a(5155),r=a(4938),l=a(7489),d=a(3578),i=a(2115),n=a(3464);let c=e=>{let{isOpen:t,onClose:a,onSave:r,newbooking:l,onChange:d}=e,[c,o]=(0,i.useState)([]),[x,m]=(0,i.useState)(!1);(0,i.useEffect)(()=>{t&&n.A.get("".concat("https://spa-backend-test.vercel.app/api","/service")).then(e=>{o(e.data.data),console.log("Fetched Categories:",e.data.data)}).catch(e=>console.error("Error fetching categories:",e))},[t]);let g=async()=>{m(!0);try{await r()}finally{m(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 px-4 sm:px-6",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6 w-full max-w-md dark:bg-gray-900",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 dark:text-white",children:"Add booking"}),(0,s.jsx)("button",{onClick:a,className:"text-[#008767] hover:text-[#006d50] text-3xl font-bold",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"booking Name"}),(0,s.jsx)("input",{name:"name",type:"text",value:l.name,onChange:d,className:"w-full border border-gray-300 dark:border-gray-600 px-3 py-2 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"service"}),(0,s.jsxs)("select",{name:"serviceId",value:l.serviceId,onChange:d,className:"w-full border border-gray-300 dark:border-gray-600 px-3 py-2 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[(0,s.jsx)("option",{value:"",children:"Select a service"}),c.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300",children:"Price"}),(0,s.jsx)("input",{name:"price",type:"text",value:l.price,onChange:d,className:"w-full border border-gray-300 dark:border-gray-600 px-3 py-2 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,s.jsx)("div",{className:"flex flex-col sm:flex-row justify-end gap-2 mt-4",children:(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 rounded-lg bg-[#008767] text-white hover:bg-[#006d50] w-full sm:w-auto flex items-center justify-center gap-2",disabled:x,children:x?(0,s.jsxs)("svg",{className:"h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 00-8 8h4z"})]}):"Save"})})]})]})}):null};var o=a(7860);let x="https://spa-backend-test.vercel.app/api";function m(){let[e,t]=(0,i.useState)(null),[a,m]=(0,i.useState)(1),[g,h]=(0,i.useState)(!1),[u,p]=(0,i.useState)(0),[b,y]=(0,i.useState)(null),[f,j]=(0,i.useState)({name:"",serviceId:"",price:0,status:"",customerName:"",date:"",time:"",phoneNumber:"",email:""}),v=e?e.length:0,N=Math.ceil(v/3),w=3*a,[k,C]=(0,i.useState)({}),S=async()=>{try{let e=await n.A.get("".concat(x,"/booking"));console.log("API response:",e.data),Array.isArray(e.data.data)?t(e.data.data):console.error("Unexpected data structure:",e.data)}catch(e){console.error("Error fetching bookings:",e)}},A=async()=>{try{let e=await n.A.get("".concat(x,"/service")),t={};e.data.data.forEach(e=>{t[e.id]=e.name}),C(t)}catch(e){console.error("Failed to load services",e)}};(0,i.useEffect)(()=>{S(),A()},[]);let B=e?e.slice(w-3,w):[];(0,i.useEffect)(()=>{(async()=>{try{let e=await n.A.get("".concat(x,"/booking/today"));e.data&&e.data.pagination&&p(e.data.pagination.total)}catch(e){console.error("Error fetching today's bookings:",e)}})()},[]);let E=e=>{y(e),j({name:e.name,serviceId:e.serviceId,price:e.price,status:e.status,customerName:e.customerName,date:e.date,time:e.time,phoneNumber:e.phoneNumber,email:e.email}),h(!0)},[I,M]=(0,i.useState)(!1),[P,T]=(0,i.useState)({name:"",serviceId:"",price:0,status:"",customerName:"",date:"",time:"",phoneNumber:"",email:""}),z=e=>{let{name:t,value:a}=e.target;T(e=>({...e,[t]:a})),S()},D=async()=>{try{var e,t;let a=(null===(e=document.cookie.split("; ").find(e=>e.startsWith("token=")))||void 0===e?void 0:e.split("=")[1])||"",s=await n.A.post("".concat(x,"/booking/create"),P,{headers:{Authorization:"Bearer ".concat(a)},withCredentials:!0});console.log("Booking added:",null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.booking),M(!1),S()}catch(e){console.error("Error adding booking:",e)}};return(0,s.jsxs)("div",{className:"relative bg-cover bg-center min-h-screen",children:[(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)(r.default,{})}),(0,s.jsx)("div",{className:"px-4 sm:px-6 lg:px-8 py-6 space-y-20 md:ml-[260px]",children:(0,s.jsxs)("div",{className:"max-w-7xl w-full mx-auto",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-8",children:"Booking Management"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[(0,s.jsx)("div",{className:"w-full sm:w-auto bg-white p-6 border-gray-200 rounded-3xl shadow-sm dark:bg-gray-800 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"bg-green-100 text-green-600 p-3 rounded-full",children:(0,s.jsx)(l.g,{icon:d.wM0,className:"text-2xl"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-semibold text-gray-400 dark:text-white mb-1",children:"Total Bookings"}),(0,s.jsx)("p",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:v})]})]})}),(0,s.jsx)("div",{className:"w-full sm:w-auto bg-white p-6 border-gray-200 rounded-3xl shadow-sm dark:bg-gray-800 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"bg-green-100 text-green-600 p-3 rounded-full",children:(0,s.jsx)(l.g,{icon:d.wM0,className:"text-2xl"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-semibold text-gray-400 dark:text-white mb-1",children:"Total Bookings for Today"}),(0,s.jsx)("p",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:u})]})]})})]}),(0,s.jsx)(c,{isOpen:I,onClose:()=>M(!1),onSave:D,newbooking:P,onChange:z}),(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-2xl p-4 sm:p-6 dark:bg-gray-900",children:[(0,s.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4",children:(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-white",children:"Booking List"})}),(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-sm rounded-lg",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[(0,s.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left",children:"Customer Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left",children:"Service"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left",children:"Phone Number"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left",children:"Email"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right",children:"Status"})]})}),(0,s.jsx)("tbody",{children:B.map(e=>(0,s.jsxs)("tr",{onClick:()=>E(e),className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-3 text-left",children:"".concat(e.firstName," ").concat(e.lastName)}),(0,s.jsx)("td",{className:"px-6 py-3 text-left",children:k[e.serviceId]||"Loading..."}),(0,s.jsx)("td",{className:"px-6 py-3 text-left",children:e.phoneNumber}),(0,s.jsx)("td",{className:"px-6 py-3 text-left",children:e.email||"null"}),(0,s.jsx)("td",{className:"px-6 py-3 text-right",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded-lg text-xs font-semibold ".concat("Approved"===e.status?"bg-green-100 text-green-800":"Pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})})]},e.id))})]})}),b&&(0,s.jsx)(o.A,{showModal:g,setShowModal:h,editForm:f,handleAddBookingChange:z,serviceId:b.serviceId,BURL:x||"",closeModal:()=>h(!1),selectedItem:b,refreshData:S}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,s.jsx)("button",{onClick:()=>m(e=>Math.max(e-1,1)),disabled:1===a,className:"px-4 py-2 bg-gray-200 text-gray-600 rounded-lg",children:"Previous"}),(0,s.jsxs)("span",{className:"text-gray-700",children:["Page ",a," of ",N]}),(0,s.jsx)("button",{onClick:()=>{m(e=>Math.min(e+1,N))},disabled:a===N,className:"px-4 py-2 bg-gray-200 text-gray-600 rounded-lg",children:"Next"})]})]})]})})]})}},7860:(e,t,a)=>{a.d(t,{A:()=>d});var s=a(5155),r=a(2115),l=a(3464);let d=e=>{let{showModal:t,selectedItem:a,closeModal:d,setShowModal:i,refreshData:n}=e,[c,o]=(0,r.useState)((null==a?void 0:a.status)||"Pending"),[x,m]=(0,r.useState)(""),[g,h]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{a&&o(a.status)},[a]);let b=async()=>{p(!0);try{var e;let t=(null===(e=document.cookie.split("; ").find(e=>e.startsWith("token=")))||void 0===e?void 0:e.split("=")[1])||"";await l.A.put("".concat("https://spa-backend-test.vercel.app/api","/booking/edit/").concat(null==a?void 0:a.id),{status:c},{headers:{Authorization:"Bearer ".concat(t)},withCredentials:!0}),m("Booking status updated successfully!"),h("success"),setTimeout(()=>{i(!1),m(""),h(""),p(!1),n&&n()},1500)}catch(e){console.error("Error updating booking status:",e),m("Failed to update status. Please try again."),h("error"),p(!1)}};if(!t||!a)return null;let y=a.dateTime?new Date(a.dateTime):null;return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/70 bg-opacity-50 flex items-center justify-center z-50 px-4 sm:px-6",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6 w-full max-w-md dark:bg-gray-900",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 dark:text-white",children:"Booking Details"}),(0,s.jsx)("button",{onClick:d,className:"text-[#008767] hover:text-[#006d50] text-3xl font-bold",children:"\xd7"})]}),(0,s.jsxs)("p",{className:"mb-5 text-sm text-center text-gray-600 dark:text-gray-300",children:["Update status for ",(0,s.jsx)("strong",{children:a.customerName||"Customer"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex-1 bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-lg text-sm text-gray-800 dark:text-white shadow-sm",children:[(0,s.jsx)("strong",{children:"Date:"})," ",a.dateTime?new Date(a.dateTime).toLocaleDateString():"N/A"]}),(0,s.jsxs)("div",{className:"flex-1 bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-lg text-sm text-gray-800 dark:text-white shadow-sm",children:[(0,s.jsx)("strong",{children:"Time:"})," ",y?y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"status",className:"block mb-2 text-sm font-medium text-[#008767] dark:text-gray-300",children:"Change Status"}),(0,s.jsxs)("select",{id:"status",value:c,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#008767] pr-10",children:[(0,s.jsx)("option",{value:"Approved",children:"Approved"}),(0,s.jsx)("option",{value:"Pending",children:"Pending"}),(0,s.jsx)("option",{value:"Rejected",children:"Rejected"})]})]}),x&&(0,s.jsx)("p",{className:"mt-2 text-sm text-center ".concat("success"===g?"text-green-600":"text-red-600"),children:x}),(0,s.jsx)("div",{className:"mt-6 flex justify-end",children:(0,s.jsx)("button",{onClick:b,disabled:u,className:"bg-[#008767] text-white px-4 py-2 rounded-lg hover:bg-[#006d50] transition flex items-center justify-center gap-2 min-w-[120px]",children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 00-8 8h4z"})]}),(0,s.jsx)("span",{children:"Saving..."})]}):"Save Changes"})})]})})}}}]);